<!doctype html>
<html lang="pt-BR">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Renova — Relatórios</title>
    <link rel="stylesheet" href="adm.css">
</head>

<body>
    <header class="admin-topbar">
        <div class="brand-left">Renova</div>
        <div class="top-actions"><a class="btn btn-primary" href="index.html">Sair</a></div>
    </header>
    <div class="admin-shell">
        <aside class="sidebar">
            <div class="brand">
                <div class="logo"></div>
                <div class="title">Renova</div>
            </div>
            <nav>
                <ul>
                    <li><a href="dashboard.html">Dashboard</a></li>
                    <li><a href="gestao.html">Gestão de Vendas</a></li>
                    <li><a href="historico.html">Histórico de Interações</a></li>
                    <li><a href="tarefas.html">Tarefas e Lembretes</a></li>
                    <li><a href="relatorios.html">Relatórios</a></li>
                    <li><a href="acesso.html">Controle de Acesso</a></li>
                     <li><a href="helpdesk.html">Helpdesk</a></li>
                </ul>
            </nav>
        </aside>

        <main class="admin-main">
            <div class="box">
                <h3>Gerar Relatório</h3>
                <div style="display:flex;gap:8px;align-items:center">
                    <input type="date" id="desde"> <span style="color:var(--muted)">a</span> <input type="date"
                        id="ate">
                    <button class="btn btn-primary" id="btnGerar">Gerar</button>
                </div>
                <div id="outRel" style="margin-top:10px;color:var(--muted)"></div>
            </div>
        </main>
    </div>

    <script src="admin-common.js"></script>
    <script>
        // gera relatório simples a partir das oportunidades salvas em localStorage
        document.getElementById('btnGerar').addEventListener('click', function () {
            const desde = document.getElementById('desde').value;
            const ate = document.getElementById('ate').value;
            const ops = JSON.parse(localStorage.getItem('renova_oportunidades') || '[]');
            const filtered = ops.filter(o => {
                if (!desde && !ate) return true;
                const p = o.previsao || o.previsao || '';
                if (desde && p && p < desde) return false;
                if (ate && p && p > ate) return false;
                return true;
            });
            const total = filtered.reduce((s, x) => s + (Number(x.valor) || 0), 0);
            document.getElementById('outRel').innerHTML = `<div>Nº oportunidades: <strong>${filtered.length}</strong></div><div>Faturamento estimado: <strong>R$ ${total.toLocaleString('pt-BR')}</strong></div>`;
        });
    </script>
</body>

</html>